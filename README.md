# 2FA_study
2FAについて学ぶために簡単なログインサイトと認証アプリを作ったり、ChatGPTや書籍から得た知識をまとめます。   

------------    
# 2FA認証とは
3つの認証要素
| 種類 | 内容 | 例 |
|---|---|---|
| 知識情報（Something you know） | 知っているもの | パスワード、PINコード |
| 所持情報（Something you have） | 持っているもの | スマホ、トークンキー、ICカード |
| 生体情報（Something you are） | 身体的特徴 | 指紋、顔、声 |

のなかから異なる二つを使う。
2FA認証アプリの場合は
- 知識情報：パスワード
- 所持情報：認証アプリ  
の2つ。

----  

# 2FAのセキュリティ的価値と課題

## メリット
- パスワード漏洩だけでは突破されにくい
- フィッシング対策にも有効（特にプッシュ型やハードウェア型）  

## 課題と注意点
- スマホ紛失＝認証手段の消失 → バックアップコード必須
- 時間ズレ・時計の同期ミス → TOTPでエラー発生
- フィッシングによるリアルタイム盗み取り（中間者攻撃）  

-----   

# 2FA認証の種類
- OTP（ワンタイムパスワード - One Time Password）
   - 時間ベース型（TOTP: Time-Based OTP）   
	•	Google Authenticator, Authy などがこれ   
	•	時間（通常30秒）に応じてコードが変わる   
	•	秘密鍵（Secret Key）を元にしてローカル生成  
   - イベントベース型（HOTP: HMAC-based OTP）  
	•	使うたびにカウンターが進む  

- プッシュ通知で認証  
  - 端末に「このログインを許可しますか？」と表示され、ワンタップで承認  

- ハードウェアトークン  
  - 端末に「このログインを許可しますか？」と表示され、ワンタップで承認
 
- 生体認証
  - Windows Hello , Face ID , 指紋認証　など
  - 通常はFIDO2との組み合わせで使用される。

----  
# 2FAの背後にあるプロトコルと標準技術   

| 技術 |	概要 |
|---|---|
| TOTP/HOTP (RFC 4226, RFC 6238) | ワンタイムパスワードの標準 |
| FIDO2 / WebAuthn | パスワードレス認証を支える規格（YubiKeyやWindows Helloが使う） |
| OATH | OTP標準を推進する業界団体（TOTP/HOTPはここで策定） |

------  
# 今回のターゲット  

👤 ユーザーが2FA設定時に行う操作
	1.	サービスの2FA設定画面で QRコード or 秘密キー を取得
	2.	認証アプリに登録
	3.	表示されるコードを入力して確認
	4.	バックアップコードを安全に保存！（スマホ紛失時用）

のうち、サービスと認証アプリを簡易的に作成。


-------  
# システム設計者・開発者向け知識(ChatGPTからそのまま持ってきた)

- 実装ライブラリ例（TOTP/HOTP）
  - Python: pyotp
  - JavaScript: otplib
  - Go: github.com/pquerna/otp

- セキュアな2FAの実装設計
  - サーバー側で秘密鍵を安全に管理（例：HSM）
  - FIDO2は公開鍵暗号方式なので秘密鍵を保持しなくてよい
  - 認証フローに「タイムアウト」や「再認証」なども組み込むとより強固


 
